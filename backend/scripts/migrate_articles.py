#!/usr/bin/env python3
"""Скрипт миграции существующих статей в БД.

Миграция 6 статей из React-компонентов в базу данных через API.

Запуск:
    export API_URL="https://api.kleykod.ru"
    export ADMIN_API_KEY="your-admin-key"
    python migrate_articles.py
"""

import os

import httpx

API_URL = os.getenv("API_URL", "https://api.kleykod.ru")
ADMIN_API_KEY = os.getenv("ADMIN_API_KEY", "")

ARTICLES = [
    {
        "slug": "kak-nastroit-kleykod-za-5-minut",
        "title": "Как настроить KleyKod за 5 минут",
        "description": "Пошаговая инструкция по быстрой настройке сервиса KleyKod для генерации этикеток Wildberries и Честный Знак",
        "content": """# Как настроить KleyKod за 5 минут

Генератор этикеток для Wildberries и Ozon с кодами маркировки Честный Знак. Пошаговая инструкция: от загрузки файлов до печати этикеток на термопринтере.

## Что такое KleyKod?

KleyKod — это генератор этикеток для маркетплейсов (Wildberries, Ozon), который объединяет штрихкоды товаров и коды маркировки Честный Знак в одну наклейку. Вместо двух этикеток на товаре — одна.

- **Бесплатно** — 50 этикеток/день
- **Проверка качества** DataMatrix
- **Без установки** — работает в браузере

## 5 шагов к готовым этикеткам

### Шаг 1: Скачайте Excel с баркодами из WB

Зайдите в ЛК Wildberries → Товары и цены → Карточки товаров. Выберите нужные товары и нажмите «Редактировать» → «Excel» → «Сохранить».

> **Совет:** Подробная инструкция в статье «Как скачать Excel с баркодами». Файл должен содержать колонку «Штрихкод товара».

### Шаг 2: Скачайте PDF с кодами Честный Знак

В личном кабинете ЧЗ перейдите в «Коды маркировки» → выберите товарную группу → «Скачать PDF». Это файл с DataMatrix кодами.

> **Совет:** Инструкция в статье «Как получить коды маркировки ЧЗ». Один PDF может содержать коды для нескольких товаров.

### Шаг 3: Загрузите файлы в KleyKod

На главной странице KleyKod нажмите «Создать этикетки». Загрузите Excel-файл из WB и PDF с кодами ЧЗ. Система автоматически сопоставит товары по GTIN.

> **Совет:** Можно перетащить файлы мышкой (drag & drop). Поддерживаются .xlsx, .xls и .pdf форматы.

### Шаг 4: Настройте шаблон этикетки

Выберите размер этикетки (58×40 мм — стандарт для WB) и layout: Basic (минимум), Professional (с артикулом) или Extended (кастомные поля).

> **Совет:** Preview обновляется в реальном времени.

### Шаг 5: Скачайте готовый PDF

Нажмите «Создать PDF». KleyKod проверит качество кодов (размер DataMatrix ≥22мм, контрастность ≥80%) и сгенерирует файл для печати.

> **Совет:** Если код не проходит проверку — система предупредит. PDF готов к печати на термопринтере.

## Возможности генератора этикеток

- **Live-превью** — видите готовую этикетку до печати в реальном времени
- **3 шаблона** — Basic, Professional, Extended — от минимума до полной кастомизации
- **База товаров** — сохраняйте карточки товаров для быстрой генерации (Про)
- **Диапазон печати** — печатайте частями: этикетки 5-15 из 50, например

## Размеры этикеток для маркетплейсов

| Размер | Применение | Layouts |
|--------|------------|---------|
| 58×30 мм | Мелкие товары, косметика | Basic, Professional |
| **58×40 мм** | **Стандарт WB и Ozon** | **Все шаблоны** |
| 58×60 мм | Крупные товары, много информации | Все шаблоны |

## Частые вопросы

**Как печатать этикетки на термопринтере?**
Скачайте PDF из KleyKod и откройте в любой программе для печати. Выберите принтер, установите размер бумаги 58×40 мм (или ваш размер), масштаб 100%. Печатайте без полей.

**Какой принтер нужен для печати этикеток Честный Знак?**
Любой термопринтер с разрешением от 203 dpi. Популярные модели: Xprinter XP-365B (бюджет), TSC TE200 (средний), Godex G500 (проф). Подробнее в статье «Какой принтер купить».

**Можно ли печатать этикетки бесплатно?**
Да, бесплатный тариф — 50 этикеток в день. Без ограничений по функциям. Про (500/день) — 490₽/мес, Бизнес (безлимит) — 1990₽/мес.

---

*50 бесплатных этикеток каждый день. Создайте первые этикетки прямо сейчас!*
""",
        "category": "Быстрый старт",
        "reading_time": 5,
        "is_published": True,
    },
    {
        "slug": "kak-skachat-excel-s-barkodami-wildberries",
        "title": "Как скачать Excel с баркодами из Wildberries",
        "description": "Пошаговая инструкция: как выгрузить файл с баркодами товаров из личного кабинета Wildberries для печати этикеток с Честным Знаком",
        "content": """# Как скачать Excel с баркодами из Wildberries

Пошаговая инструкция по выгрузке файла с баркодами товаров из личного кабинета WB Partners. Этот файл нужен для создания этикеток с маркировкой Честный Знак.

## Коротко

1. Откройте **Товары и цены → Карточки товаров**
2. Выберите нужные товары галочками
3. Нажмите **Редактировать → Excel → Сохранить**

## Шаг 1: Откройте раздел «Карточки товаров»

Войдите в личный кабинет [WB Partners](https://seller.wildberries.ru) и перейдите в раздел **«Товары и цены»** → **«Карточки товаров»**. Здесь отображается список всех ваших товаров с баркодами (штрихкодами).

Выберите товары, для которых нужно скачать баркоды — поставьте галочки слева. Можно выбрать все товары или только часть.

> **Совет:** После выбора товаров внизу появится панель с кнопками. Нажмите **«Редактировать»** для перехода к массовому редактированию.

## Шаг 2: Выгрузите данные в Excel

На странице массового редактирования найдите кнопку **«Excel»** в правом верхнем углу. Нажмите на неё и выберите **«Сохранить»**. Файл начнёт загружаться.

## Шаг 3: Проверьте скачанный файл

Откройте скачанный **.xlsx файл**. Он содержит все данные о товарах, включая колонку **«Штрихкод товара»** (баркод) — именно она нужна для создания этикеток.

### Что содержит файл:

- **Штрихкод товара** — баркод для этикетки
- **Наименование** — название товара
- **Артикул продавца** — ваш внутренний артикул
- **Размер, цвет** — характеристики товара

## Что дальше?

Загрузите этот Excel-файл в KleyKod вместе с кодами Честного Знака — получите готовые этикетки для печати за 5 секунд.

---

*50 этикеток в день — бесплатно, без регистрации карты*
""",
        "category": "Инструкция",
        "reading_time": 3,
        "is_published": True,
    },
    {
        "slug": "kak-poluchit-kody-markirovki-chestny-znak",
        "title": "Как получить коды маркировки Честный Знак",
        "description": "Пошаговая инструкция по скачиванию кодов маркировки из личного кабинета системы Честный Знак для печати этикеток",
        "content": """# Как получить коды маркировки Честный Знак

Пошаговая инструкция по скачиванию кодов маркировки из личного кабинета системы Честный Знак. Покажем, как заказать коды впервые и как повторно распечатать уже полученные.

## Что такое коды маркировки?

**Коды маркировки Честный Знак** — это уникальные идентификаторы товаров в формате DataMatrix. Каждый код содержит информацию о товаре и криптографическую подпись. Без кодов маркировки нельзя легально продавать товары, подлежащие обязательной маркировке: одежду, обувь, парфюмерию и другие категории.

## Первое получение кодов

### Шаг 1: Откройте раздел «Заказы»

В личном кабинете Честного Знака перейдите в раздел «Заказы». Здесь отображаются все ваши заказы на коды маркировки. После генерации кодов статус заказа изменится на «Доступен».

> **Совет:** Коды маркировки генерируются автоматически после оплаты. Обычно это занимает от нескольких секунд до нескольких минут.

### Шаг 2: Выберите заказ

Найдите нужный заказ в списке и нажмите на его номер (идентификатор). Вы перейдёте на страницу с деталями заказа, где можно скачать коды маркировки.

> **Совет:** Заказы со статусом «Доступен» содержат готовые коды для печати.

### Шаг 3: Нажмите «Перейти к печати»

На странице заказа вы увидите общие данные: товарную группу, статус, способ выпуска товаров в оборот. Нажмите кнопку «Перейти к печати» в правом нижнем углу.

### Шаг 4: Скачайте коды маркировки

Откроется вкладка «Товары» со списком кодов. Нажмите на иконку принтера в колонке «Действия» — файл с кодами маркировки начнёт скачиваться на ваш компьютер.

> **Совет:** Файл скачивается в формате PDF. Это именно тот файл, который нужно загрузить в KleyKod.

### Шаг 5: Файл успешно сформирован

После нажатия на принтер система сформирует PDF-файл с кодами маркировки и автоматически скачает его. Для повторной загрузки перейдите в раздел Документы → Печать/Экспорт.

## Повторное получение кодов

### Шаг 1: Перейдите в Документы → Печать/Экспорт

Для повторного получения кодов маркировки откройте раздел «Документы» и выберите вкладку «Печать/Экспорт». Здесь хранятся все ранее сформированные файлы.

> **Важно:** Функция повторного получения файла с кодами маркировки доступна в течение 2 суток.

### Шаг 2: Выберите действие

В колонке «Действия» доступны две иконки: «Скачать» — для сохранения ранее сформированного файла, «Печать» — для повторной печати кодов маркировки.

### Шаг 3: Выберите формат файла

При повторной печати можно выбрать формат: PDF, CSV или EPS. **Важно:** CSV и EPS не могут быть преобразованы в DataMatrix для нанесения на товар. Для KleyKod выбирайте PDF.

> **Совет:** Для работы с KleyKod всегда выбирайте формат PDF — он содержит DataMatrix коды, готовые для печати.

## Частые вопросы

**Сколько стоят коды маркировки Честный Знак?**
Стоимость одного кода маркировки составляет 60 копеек без НДС (с 1 февраля 2025 года). Оплата производится при заказе кодов в личном кабинете Честного Знака.

**Можно ли повторно распечатать коды маркировки?**
Да, повторная печать кодов маркировки доступна в течение 2 суток через раздел Документы → Печать/Экспорт. Выбирайте формат PDF для работы с KleyKod.

**В каком формате скачиваются коды маркировки?**
Коды маркировки скачиваются в формате PDF с DataMatrix кодами. Этот файл можно загрузить в KleyKod для создания этикеток с штрихкодом Wildberries и кодом Честного Знака на одной наклейке.

---

*Скачали коды маркировки? Загрузите PDF в KleyKod вместе с Excel-файлом из Wildberries — получите готовые этикетки за 5 секунд. 50 этикеток в день — бесплатно.*
""",
        "category": "Инструкция",
        "reading_time": 5,
        "is_published": True,
    },
    {
        "slug": "pochemu-datamatrix-ne-skaniruetsya",
        "title": "Почему DataMatrix не сканируется — причины и решения",
        "description": "Не читается честный знак? Разбираем типичные проблемы с маркировкой: качество печати, настройки сканера, размер кода. Пошаговые решения для селлеров",
        "content": """# Почему DataMatrix не сканируется — причины и решения

**Не читается честный знак** при приёмке на складе или в магазине? Разбираем типичные проблемы с маркировкой и даём пошаговые решения для каждой ситуации.

## Быстрая проверка — 5 пунктов

- [ ] Размер DataMatrix минимум 22×22 мм
- [ ] Контрастность не менее 80%
- [ ] Используется 2D-сканер (не лазерный)
- [ ] Сканер в режиме COM-порта
- [ ] Код напечатан на качественной этикетке

Когда **код маркировки не сканируется**, селлеры теряют время и деньги: товар не принимают на склад, покупатели возвращают заказы, а печать этикеток маркировки приходится повторять заново. По статистике, 80% проблем связаны с тремя причинами: качество печати, размер кода и настройки сканера.

## Три главные причины проблем

### 1. Качество печати

**Проблемы:**
- Дешёвые этикетки с плохой адгезией
- Изношенный риббон (термотрансферная лента)
- Принтер с разрешением ниже 203 dpi
- Размытые контуры L-паттерна DataMatrix
- Низкая контрастность (код сливается с фоном)

**Решения:**
- Используйте термотрансферные этикетки (полуглянец/мат)
- Меняйте риббон каждые 3-5 рулонов этикеток
- Принтер минимум 203 dpi, рекомендуется 300 dpi
- Проверяйте чёткость L-паттерна визуально
- KleyKod проверяет контрастность автоматически (мин. 80%)

### 2. Размер DataMatrix

**Проблемы:**
- Код меньше 10×10 мм — сканер считывает нестабильно
- Код 15×15 мм — требует повторного сканирования
- Нарушены требования Честного Знака
- Quiet zone (тихая зона) вокруг кода слишком мала

**Решения:**
- Минимальный размер по ЧЗ — 22×22 мм
- KleyKod автоматически проверяет размер при генерации
- Оставляйте тихую зону минимум 2 мм вокруг кода
- Используйте этикетки 58×40 мм или больше

### 3. Настройки оборудования

**Проблемы:**
- Линейный лазерный сканер (читает только EAN-13)
- Сканер в режиме эмуляции клавиатуры
- ПО не разбирает код на компоненты (GTIN, серийник)
- 1С или касса неправильно настроены

**Решения:**
- Используйте 2D-сканер (имиджер) с поддержкой DataMatrix
- Переключите сканер в режим COM-порта
- Настройте парсинг кода в учётной системе
- Проверьте полный код включая символы GS и крипто-хвост

## Почему не читается маркировка Честный Знак?

**Честный знак не читается код** чаще всего из-за ошибок в структуре GS1 DataMatrix. Визуально код выглядит нормально, но внутри нарушена последовательность данных:

- **FNC1** — специальный символ в начале кода. Если его нет или заменён на текст «FNC1» (4 буквы вместо 1 символа) — код не валиден.
- **GS-разделители** — отделяют поля в коде. Нельзя ставить после GTIN (поле 01) или заменять на текст «GS».
- **Крипто-хвост** — последняя часть кода (91 и 92 поля). Если обрезан или повреждён — верификация не пройдёт.

## Минимальные требования для печати

| Параметр | Минимум | Рекомендация |
|----------|---------|--------------|
| Размер DataMatrix | 22×22 мм | 25×25 мм |
| Разрешение принтера | 203 dpi | 300 dpi |
| Контрастность | 80% | 90%+ |
| Тихая зона | 1 мм | 2-3 мм |
| Тип сканера | 2D имиджер | 2D имиджер с автофокусом |

## Частые вопросы

**Почему лазерный сканер не читает DataMatrix?**
Лазерные сканеры работают только с линейными штрихкодами (EAN-13, Code-128). DataMatrix — двумерный код, для него нужен 2D-сканер (имиджер), который делает «фото» кода и распознаёт его.

**Код сканируется, но Честный Знак его не принимает. Почему?**
Скорее всего проблема в структуре кода: отсутствует символ FNC1, неправильно расставлены GS-разделители или повреждён крипто-хвост. Проверьте полный код, включая все служебные символы.

**Можно ли печатать DataMatrix на обычном офисном принтере?**
Технически можно, но качество будет нестабильным. Лазерные принтеры дают 600 dpi, но тонер может смазываться. Струйные — расплываются на обычной бумаге. Рекомендуем термопринтер от 203 dpi.

**Как проверить качество кода перед печатью?**
KleyKod автоматически проверяет размер DataMatrix (минимум 22×22 мм) и контрастность (минимум 80%) при генерации этикеток. Если код не проходит проверку — система предупредит.

---

*KleyKod автоматически проверяет размер DataMatrix и контрастность. Если код не соответствует требованиям ЧЗ — система предупредит до печати. 50 этикеток в день — бесплатно.*
""",
        "category": "Решение проблем",
        "reading_time": 4,
        "is_published": True,
    },
    {
        "slug": "kakoy-printer-kupit-dlya-etiketok-58x40",
        "title": "Какой принтер купить для этикеток 58x40 — обзор термопринтеров 2026",
        "description": "Какой термопринтер для этикеток выбрать селлеру Wildberries и Ozon? Сравнение Xprinter 365B, TSC TE200, Godex G500: цены, характеристики, рекомендации по объёмам",
        "content": """# Какой принтер купить для этикеток 58×40

Объективное сравнение термопринтеров для этикеток с кодами маркировки Честный Знак. Разбираем Xprinter 365B, TSC TE200, Godex и другие модели: цены, характеристики, рекомендации по объёмам.

## Быстрая рекомендация

| Объём | Модель | Цена |
|-------|--------|------|
| До 50 шт/день | Xprinter XP-365B | 5 000 — 8 000 ₽ |
| **50-500 шт/день** | **TSC TE300 (300 dpi)** | **25 000 — 35 000 ₽** (Рекомендуем) |
| 500+ шт/день | TSC ML340 / Godex G530 | 45 000 — 85 000 ₽ |

## Главное при выборе термопринтера для этикеток

- **Разрешение 300 dpi** — для стабильной печати DataMatrix. 203 dpi — минимум, но рискованно.
- **Ширина печати ≥104 мм** — для этикетки 58×40 + текст. 72 мм — впритык.
- **Термотрансфер (риббон)** — для долговечности. Термо — только для краткосрочного хранения.
- **Запас по объёму +20-30%** — выбирайте с запасом на рост.

## Сравнительная таблица термопринтеров

| Модель | Разрешение | Тип | Цена | Для кого |
|--------|------------|-----|------|----------|
| MPRINT LP58 EVA | 203 dpi | Термо | 4 500 — 12 800 ₽ | До 50 этикеток/день |
| Xprinter XP-365B | 203 dpi | Термо | 5 000 — 8 000 ₽ | До 100 этикеток/день |
| АТОЛ ТТ42 | 203 dpi | Термотрансфер | ~13 800 ₽ | До 100 этикеток/день |
| Honeywell PC42T | 203 dpi | Термотрансфер | 15 500 — 19 300 ₽ | 50-200 этикеток/день |
| **TSC TE200 / TE300** | **203 / 300 dpi** | **Термотрансфер** | **15 000 — 35 000 ₽** | **100-500 этикеток/день** (Рекомендуем) |
| Godex G500 / G530 | 203 / 300 dpi | Термотрансфер | 30 000 — 45 000 ₽ | 200-800 этикеток/день |
| TSC ML340 | 300 dpi | Термотрансфер | 60 000 — 85 000 ₽ | 1000+ этикеток/день |
| Zebra ZT510 | 203/300/600 dpi | Термотрансфер | 139 000 — 252 000 ₽ | 5000+ этикеток/день |

*Цены актуальны на январь 2026.*

## Термопечать vs Термотрансфер — что выбрать?

### Термопечать (прямая термо)

**Плюсы:**
- Принтер дешевле на 20-30%
- Только этикетки (0.10-0.15 ₽/шт)

**Минусы:**
- Срок жизни 3-12 месяцев
- Выцветает на солнце
- Боится влаги и мороза

> **Подходит:** продукты питания, расходники — товары с коротким циклом продажи (2-3 недели).

### Термотрансфер (с риббоном)

**Плюсы:**
- Срок жизни до 3 лет
- Водостойкость, морозостойкость до -40°C
- Устойчивость к УФ и механике

**Минусы:**
- Нужен риббон (0.25-0.35 ₽/шт)
- Принтер дороже

> **Рекомендуем для WB/Ozon:** товары на складах, логистика, возвраты — нужна долговечность.

## Рекомендации по объёмам

### До 50 этикеток/день

Микро-бизнес, начинающий селлер, тестирование ниши.

- **Xprinter XP-365B** — 5 000 — 8 000 ₽ • Термо • 203 dpi. Самый популярный бюджетный вариант.
- **АТОЛ ТТ42** — ~13 800 ₽ • Термотрансфер • 203 dpi. Если нужна долговечность этикетки.

### 50-500 этикеток/день (Рекомендуем)

Малый бизнес, активный селлер Wildberries/Ozon.

- **TSC TE300 (300 dpi)** — 25 000 — 35 000 ₽ • Термотрансфер. **Лучший выбор.** Стандарт для WB/Ozon.
- **Honeywell PC42T** — 15 500 — 19 300 ₽ • Термотрансфер • 203 dpi. Бюджетнее, но риск с качеством DataMatrix.

### 500+ этикеток/день

Средний бизнес, склад, производство.

- **TSC ML340 (300 dpi)** — 60 000 — 85 000 ₽ • Промышленный. Лучший компромисс цена/производительность.
- **Godex G530 (300 dpi)** — 37 800 — 45 100 ₽ • Полупромышленный. Дешевле TSC, тот же уровень качества.

## Частые ошибки при выборе

1. **Экономия на 203 dpi для маркировки** — коды либо не читаются на сортировочном центре WB, либо читаются с ошибками. Экономия 5-10 тыс. стирается за 2-3 брака.

2. **Ширина печати 72-80 мм** — достаточно для кода 58×40, но без места на текст производителя. Минимум 104-108 мм.

3. **Термопечать для товаров с длинным циклом** — если товар лежит на складе месяц+ или едет в регионы зимой — термоэтикетка выцветет или отвалится.

4. **Переплата за производительность** — продавец 200 этикеток/день не получит пользу от принтера на 5000 шт/день.

## Частые вопросы

**Какое минимальное разрешение нужно для DataMatrix 22×22 мм?**
203 dpi — минимум, но рискованно. При 203 dpi каждый модуль кода получит ~2 пикселя. При 300 dpi — 3-4 пикселя, что достаточно для надёжного считывания. Для маркетплейсов рекомендуем 300 dpi.

**Xprinter 365B подходит для Честного Знака?**
Да, но с оговорками. 203 dpi и термопечать — минимум. Работает для небольших объёмов (до 50-100 шт/день) и товаров с коротким циклом. Для серьёзных объёмов лучше TSC TE300.

**Где купить принтер с гарантией?**
АТОЛ и Mertech — лучшее соотношение наличие/цена в России. TSC — стандарт рынка, но доставка 1-2 недели. Официальные дилеры: Scanberry, ТСД Эксперт, Smartcode.

---

*KleyKod создаёт готовые PDF для любого термопринтера. 50 этикеток в день — бесплатно.*
""",
        "category": "Обзор",
        "reading_time": 7,
        "is_published": True,
    },
    {
        "slug": "wbcon-alternativa",
        "title": "Альтернатива wbcon и wbarcode: бесплатный генератор этикеток для Вайлдберриз",
        "description": "Честное сравнение генераторов этикеток для Wildberries: KleyKod vs wbcon vs wbarcode. Цены, функции, плюсы и минусы каждого сервиса",
        "content": """# Альтернатива wbcon и wbarcode: бесплатный генератор этикеток для Вайлдберриз

Честное сравнение генераторов этикеток для Wildberries: KleyKod vs wbcon vs wbarcode. Цены, функции, плюсы и минусы каждого сервиса. Узнайте, какой генератор наклеек для вб подойдёт именно вам.

## Коротко: почему селлеры выбирают KleyKod

- **Дешевле** — Про 490₽ vs 990₽+
- **Проверка качества** DataMatrix
- **Прозрачные** цены

## Зачем нужна альтернатива wbcon?

**Wbcon** (barcoder.wbcon.ru) — один из первых сервисов для создания этикеток для Вайлдберриз. Он популярен, но имеет недостатки:

- Нет проверки качества DataMatrix до печати — возвраты на приёмке WB
- Про-тариф от 990₽/мес — дороже аналогов
- Бесплатный тариф ограничен — только trial период

## Проблемы wbarcode

**Wbarcode** (wbarcode.ru) — ещё один генератор штрихкодов для Wildberries. Основные минусы:

- Скрытые цены — непонятно сколько стоит до регистрации
- Медленная генерация — 1-2 минуты на партию
- Нет Telegram-бота для быстрой генерации

## Сравнение генераторов этикеток для Вайлдберриз

| Функция | KleyKod (Рекомендуем) | wbcon | wbarcode |
|---------|----------------------|-------|----------|
| Бесплатный тариф | 50 этикеток/день навсегда | Ограниченный trial | Нет информации |
| Цена Про | 490 ₽/мес | от 990 ₽/мес | Скрыта |
| Проверка качества DataMatrix | Автоматическая | Нет | Нет |
| Объединение WB + ЧЗ | Автоматически | Да | Да |
| Telegram-бот | @kleykod_bot | Нет | Нет |
| API для автоматизации | REST API | Есть | Есть |
| Прозрачность цен | 100% | Средняя | Низкая |
| Скорость генерации | Мгновенно | Быстро | 1-2 минуты |

## Почему KleyKod — лучшая альтернатива wbcon

### Проверка качества (Preflight)

Единственный сервис, который проверяет DataMatrix **до печати**: размер ≥22мм, контрастность ≥80%, DPI 203. Никаких возвратов на приёмке WB.

### Честные цены

- **Старт**: 50 этикеток/день навсегда
- **Про**: 490₽/мес (500/день)
- **Бизнес**: 1990₽/мес (безлимит)

### Мгновенная генерация

В **50 раз быстрее** ручной работы. Пока wbarcode обрабатывает файлы минутами — мы генерируем PDF мгновенно.

### Telegram-бот

[@kleykod_bot](https://t.me/kleykod_bot) — генерируйте наклейки для вб прямо в мессенджере. Без регистрации, без установки.

## Сравнение цен: wbcon vs KleyKod

| Тариф | KleyKod | wbcon | wbarcode |
|-------|---------|-------|----------|
| Старт | 50/день | Trial | ? |
| Про | 490₽/мес | от 990₽/мес | Скрыта |
| Бизнес | 1990₽/мес | Договор | Скрыта |

## Частые вопросы об альтернативах wbcon

**Можно ли использовать wbcon бесплатно?**
Wbcon предлагает только trial-период. После окончания нужно оплатить подписку. KleyKod даёт 50 этикеток в день бесплатно навсегда — без ограничения по времени.

**Чем KleyKod лучше wbarcode?**
KleyKod быстрее (мгновенная генерация vs 1-2 минуты), имеет прозрачные цены (wbarcode скрывает стоимость), и проверяет качество DataMatrix до печати.

**Можно ли перейти с wbcon на KleyKod?**
Да, переход занимает 5 минут. Загрузите тот же Excel из WB и PDF с кодами ЧЗ — KleyKod примет их без изменений. Форматы файлов совместимы.

**Какой генератор этикеток для Вайлдберриз лучше для начинающих?**
KleyKod — бесплатный тариф без ограничения по времени (50 этикеток/день), простой интерфейс, Telegram-бот для быстрой генерации без регистрации.

---

*50 этикеток в день бесплатно. Проверка качества DataMatrix. Прозрачные цены. Переход с wbcon за 5 минут.*
""",
        "category": "Сравнение",
        "reading_time": 7,
        "is_published": True,
    },
]


def main() -> None:
    """Миграция статей в БД через API."""
    if not ADMIN_API_KEY:
        print("Ошибка: ADMIN_API_KEY не установлен")
        print("Установите переменную окружения:")
        print('  export ADMIN_API_KEY="your-admin-key"')
        return

    print(f"API URL: {API_URL}")
    print(f"Количество статей для миграции: {len(ARTICLES)}")
    print("-" * 50)

    success_count = 0
    skip_count = 0
    error_count = 0

    with httpx.Client(timeout=30.0) as client:
        for article in ARTICLES:
            try:
                response = client.post(
                    f"{API_URL}/api/v1/articles",
                    headers={"X-API-Key": ADMIN_API_KEY},
                    json=article,
                )

                if response.status_code == 201:
                    print(f"[OK] Создана: {article['slug']}")
                    success_count += 1
                elif response.status_code == 409:
                    print(f"[SKIP] Уже существует: {article['slug']}")
                    skip_count += 1
                else:
                    print(
                        f"[ERROR] {response.status_code}: {article['slug']} "
                        f"- {response.text[:100]}"
                    )
                    error_count += 1
            except httpx.RequestError as e:
                print(f"[ERROR] Сетевая ошибка: {article['slug']} - {e}")
                error_count += 1

    print("-" * 50)
    print(f"Результат: {success_count} создано, {skip_count} пропущено, {error_count} ошибок")


if __name__ == "__main__":
    main()
